            db: null, // Onde os dados serão mantidos em memória
            state: { // Estado volátil da UI
                currentYear: new Date().getFullYear(),
                selectedCustoAno: null,
                selectedContribAno: null,
            },
            dataLimite: new Date(2024, 0, 1), // 1 de Janeiro de 2024

                            <p class="text-gray-300 mb-6">Controle de mensalidades e débitos individuais.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('financeiroList')">Aceder ao Financeiro</button>
                        </div>
                        <!-- Custos -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.2s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Custos do Templo</h2>
                            <p class="text-gray-300 mb-6">Registo de despesas e custos operacionais.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('custos')">Ver Custos</button>
                        </div>
                        <!-- Inadimplência -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.3s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Inadimplência</h2>
                            <p class="text-gray-300 mb-6">Relatório de adeptos com pendências financeiras.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('inadimplencia')">Ver Relatório</button>
                        </div>
                        <!-- Capital -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.4s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Capital</h2>
                            <p class="text-gray-300 mb-6">Balanço financeiro geral do templo.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('capital')">Ver Balanço</button>
                        </div>
                        <!-- Contribuições -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.5s;">
            /**
             * Renderiza a página de custos do templo.
             */
            renderCustos: function(data = {}) {
                let content = `<h2 class="text-3xl font-semibold mb-6 text-red-400">Custos do Templo</h2>`;
                const editingIndex = data.editingIndex !== undefined ? data.editingIndex : null;
                const isEditing = editingIndex !== null;
                const custo = isEditing ? this.db.custos[editingIndex] : {};
                
                // Formulário para adicionar/editar custo
                content += `
                    <div class="card-gradient p-6 rounded-lg shadow-xl mb-6">
                        <h3 class="text-xl font-semibold mb-4 text-gray-200">${isEditing ? 'Editar Custo' : 'Adicionar Novo Custo'}</h3>
                        <form id="add-custo-form" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="date" id="custo-data" class="form-input rounded-md shadow-sm" style="color-scheme: dark;" value="${custo.data || ''}" required>
                            <input type="text" id="custo-obs" placeholder="Observação" class="form-input rounded-md shadow-sm" value="${custo.obs || ''}" required>
                            <input type="number" id="custo-valor" placeholder="Valor (R$)" step="0.01" min="0.01" class="form-input rounded-md shadow-sm" value="${custo.valor || ''}" required>
                            <div class="md:col-span-3">
                                <button type="button" class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white" onclick="App.adicionarCusto(${editingIndex})">
                                    ${isEditing ? 'Atualizar Custo' : 'Adicionar Custo'}
                                </button>
                                ${isEditing ? `<button type="button" class="btn-secondary w-full px-4 py-2 rounded-md shadow-lg text-white mt-2" onclick="App.render('custos')">Cancelar Edição</button>` : ''}
                            </div>
                        </form>
                    </div>
                `;

                // Agrupamento de custos por ano e mês
                const custosAgrupados = {};
                this.db.custos.forEach((custo, index) => {
                    const data = this.parseDate(custo.data);
                    if (data) {
                        const ano = data.getFullYear();
                        const mes = data.getMonth();
                        if (!custosAgrupados[ano]) custosAgrupados[ano] = {};
                        if (!custosAgrupados[ano][mes]) custosAgrupados[ano][mes] = [];
                        custosAgrupados[ano][mes].push({ ...custo, originalIndex: index });
                    }
                });

                const anos = Object.keys(custosAgrupados).sort((a, b) => b - a);

                // Lista de custos registrados
                content += `<div class="card-gradient p-6 rounded-lg shadow-xl">
                                <h3 class="text-xl font-semibold mb-4 text-gray-200">Custos Registrados</h3>
                `;

                if (anos.length === 0) {
                    content += `<p class="text-gray-400">Nenhum custo registrado.</p>`;
                } else {
                    // Botões de Ano
                    content += `<div class="flex flex-wrap gap-2 mb-4">`;
                    anos.forEach(ano => {
                        const isSelected = ano === this.state.selectedCustoAno;
                        content += `<button class="px-4 py-2 rounded-md text-white ${isSelected ? 'btn-primary' : 'btn-secondary'}" onclick="App.selectCustoAno('${ano}')">${ano}</button>`;
                    });
                    content += `</div>`;

                    // Botões de Mês e Lista de Custos
                    if (this.state.selectedCustoAno && custosAgrupados[this.state.selectedCustoAno]) {
                        const anoData = custosAgrupados[this.state.selectedCustoAno];
                        const meses = Object.keys(anoData).sort((a, b) => a - b);
                        const nomesMeses = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];

                        meses.forEach(mes => {
                            content += `<h4 class="text-lg font-semibold text-red-300 mt-4 mb-2">${nomesMeses[mes]}</h4>`;
                            content += `<div class="space-y-3">`;
                            anoData[mes].forEach(custo => {
                                const dataCusto = this.parseDate(custo.data);
                                const isHistorico = dataCusto && dataCusto < this.dataLimite;
                                let statusClass, statusTexto;
                                if (isHistorico) {
                                    statusClass = 'bg-gray-500'; statusTexto = 'Pago (Histórico)';
                                } else if (custo.pago) {
                                    statusClass = 'bg-green-500'; statusTexto = 'Pago';
                                } else {
                                    statusClass = 'bg-red-500'; statusTexto = 'Pendente';
                                }

                                content += `
                                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center p-3 bg-gray-700 rounded-md gap-2">
                                        <div class="flex-1">
                                            <p class="font-semibold text-gray-200">${this.formatDate(custo.data)} - ${custo.obs}</p>
                                            <p class="text-sm text-gray-300">${this.formatCurrency(custo.valor)}</p>
                                        </div>
                                        <div class="flex items-center gap-2 w-full md:w-auto">
                                            <button class="flex-grow md:flex-grow-0 px-3 py-1 rounded-md text-white text-xs font-medium ${statusClass} ${isHistorico ? 'opacity-70 cursor-not-allowed' : ''}"
                                                    onclick="App.toggleCustoStatus(${custo.originalIndex})" ${isHistorico ? 'disabled' : ''}>
                                                ${statusTexto} ${!isHistorico ? '(Mudar)' : ''}
                                            </button>
                                            <button class="text-blue-400 hover:text-blue-300 p-1" onclick="App.render('custos', { editingIndex: ${custo.originalIndex} })" title="Editar">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                                            </button>
                                            <button class="text-red-500 hover:text-red-400 p-1" onclick="App.apagarCusto(${custo.originalIndex})" title="Apagar">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                                            </button>
                                        </div>
                                    </div>
                                `;
                            });
                            content += `</div>`;
                        });
                    }
                }
                content += `</div>`; // Fim do card

                return content;
            },

            /**
             * Adiciona ou atualiza um custo na base de dados.
             */
            adicionarCusto: function(editingIndex = null) {
                const data = document.getElementById('custo-data').value;
                const obs = document.getElementById('custo-obs').value;
                const valor = parseFloat(document.getElementById('custo-valor').value);

                if (data && obs && valor > 0) {
                    if (editingIndex !== null) {
                        const custoExistente = this.db.custos[editingIndex];
                        custoExistente.data = data;
                        custoExistente.obs = obs;
                        custoExistente.valor = valor;
                    } else {
                        this.db.custos.push({ data, obs, valor, pago: false });
                    }
                    this.saveDB();
                    this.render('custos');
                } else {
                    alert("Por favor, preencha todos os campos do custo.");
                }
            },

            /**
             * Apaga um custo.
             */
            apagarCusto: function(index) {
                if (confirm('Tem a certeza que quer apagar este custo?')) {
                    this.db.custos.splice(index, 1);
                    this.saveDB();
                    this.render('custos');
                }
            },

            /**
             * Alterna o status de pagamento de um custo.
             */
            toggleCustoStatus: function(index) {
                this.render('custos'); // Redesenha
            },

            /**
             * Seleciona um ano para filtrar os custos e re-renderiza.
             */
            selectCustoAno: function(ano) {
                // Se clicar no mesmo ano, deseleciona.
                this.state.selectedCustoAno = this.state.selectedCustoAno === ano ? null : ano;
                this.render('custos');
            },

            // 5.1. SEÇÃO: CONTRIBUIÇÕES

            /**
             * Renderiza a página de contribuições voluntárias.
             */
            renderContribuicoes: function(data = {}) {
                const editingIndex = data.editingIndex !== undefined ? data.editingIndex : null;
                let content = `<h2 class="text-3xl font-semibold mb-6 text-red-400">Contribuições Voluntárias</h2>`;
                const isEditing = editingIndex !== null;
                const contrib = isEditing ? this.db.contribuicoes[editingIndex] : {};
                                    ${isEditing ? 'Atualizar Contribuição' : 'Adicionar Contribuição'}
                                </button>
                                ${isEditing ? `<button type="button" class="btn-secondary w-full px-4 py-2 rounded-md shadow-lg text-white mt-2" onclick="App.render('contribuicoes')">Cancelar Edição</button>` : ''}
                            </div>
                        </form>
                    </div>
                `;

                // Agrupamento de contribuições por ano e mês
                const contribsAgrupadas = {};
                this.db.contribuicoes.forEach((contrib, index) => {
                    const data = this.parseDate(contrib.data);
                    if (data) {
                        const ano = data.getFullYear();
                        const mes = data.getMonth();
                        if (!contribsAgrupadas[ano]) contribsAgrupadas[ano] = {};
                        if (!contribsAgrupadas[ano][mes]) contribsAgrupadas[ano][mes] = [];
                        contribsAgrupadas[ano][mes].push({ ...contrib, originalIndex: index });
                    }
                });

                const anos = Object.keys(contribsAgrupadas).sort((a, b) => b - a);

                // Lista de contribuições registradas
                content += `<div class="card-gradient p-6 rounded-lg shadow-xl">
                                <h3 class="text-xl font-semibold mb-4 text-gray-200">Contribuições Registradas</h3>
                `;

                if (anos.length === 0) {
                    content += `<p class="text-gray-400">Nenhuma contribuição registrada.</p>`;
                } else {
                    // Botões de Ano
                    content += `<div class="flex flex-wrap gap-2 mb-4">`;
                    anos.forEach(ano => {
                        const isSelected = ano === this.state.selectedContribAno;
                        content += `<button class="px-4 py-2 rounded-md text-white ${isSelected ? 'btn-primary' : 'btn-secondary'}" onclick="App.selectContribAno('${ano}')">${ano}</button>`;
                    });
                    content += `</div>`;

                    // Botões de Mês e Lista de Contribuições
                    if (this.state.selectedContribAno && contribsAgrupadas[this.state.selectedContribAno]) {
                        const anoData = contribsAgrupadas[this.state.selectedContribAno];
                        const meses = Object.keys(anoData).sort((a, b) => a - b);
                        const nomesMeses = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];

                        meses.forEach(mes => {
                            content += `<h4 class="text-lg font-semibold text-red-300 mt-4 mb-2">${nomesMeses[mes]}</h4>`;
                            content += `<div class="space-y-3">`;
                            anoData[mes].forEach(c => {
                                content += `
                                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center p-3 bg-gray-700 rounded-md gap-2">
                                        <div class="flex-1">
                                            <p class="font-semibold text-gray-200">${this.formatDate(c.data)} - ${c.obs}</p>
                                            <p class="text-sm text-green-400">${this.formatCurrency(c.valor)}</p>
                                        </div>
                                    </div>
                                `;
                            });
                            content += `</div>`;
                        });
                    }
                }
                content += `</div>`; // Fim do card

                return content;
            },
                }
            },

            /**
             * Seleciona um ano para filtrar as contribuições e re-renderiza.
             */
            selectContribAno: function(ano) {
                // Se clicar no mesmo ano, deseleciona.
                this.state.selectedContribAno = this.state.selectedContribAno === ano ? null : ano;
                this.render('contribuicoes');
            },

            // 6. SEÇÃO: INADIMPLÊNCIA

            /**

