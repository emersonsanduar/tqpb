<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TQPB - Gestão Financeira</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos personalizados */
        body {
            background-color: #111827; /* Fundo escuro */
            color: #d1d5db; /* Texto claro */
        }
        .btn-primary {
            background-color: #ef4444; /* Vermelho */
            transition: background-color 0.3s;
        }
        .btn-primary:hover {
            background-color: #dc2626;
        }
        .btn-secondary {
            background-color: #4b5563; /* Cinza */
            transition: background-color 0.3s;
        }
        .btn-secondary:hover {
            background-color: #374151;
        }
        .card-gradient {
            background: linear-gradient(145deg, #1f2937, #374151);
        }
        .form-input, .form-select {
            background-color: #374151;
            border-color: #4b5563;
            color: #d1d5db;
        }
        .form-input::placeholder {
            color: #9ca3af;
        }
        /* Animação de fade-in */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        /* Estilo para o ícone de carregamento */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #ef4444;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <!-- Tela de Login -->
    <div id="login-screen" class="container mx-auto p-4 md:p-8 flex items-center justify-center min-h-screen">
        <div class="w-full max-w-sm">
            <header class="text-center mb-8">
                <h1 class="text-4xl md:text-5xl font-bold text-red-500 mb-2">Gestão TQPB</h1>
                <p class="text-lg text-gray-400">Acesso ao Sistema</p>
            </header>
            <div class="card-gradient p-8 rounded-lg shadow-xl">
                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="username" class="block text-sm font-medium text-gray-300 mb-1">Usuário</label>
                        <input type="text" id="username" class="form-input w-full rounded-md shadow-sm" required>
                    </div>
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-300 mb-1">Senha</label>
                        <input type="password" id="password" class="form-input w-full rounded-md shadow-sm" required>
                    </div>
                    <button type="button" class="btn-primary w-full px-4 py-3 rounded-md shadow-lg text-white font-semibold" onclick="App.handleLogin()">Entrar</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Conteúdo Principal da Aplicação (inicialmente oculto) -->
    <div id="app" class="container mx-auto p-4 md:p-8" style="display: none;">
        <!-- Cabeçalho -->
        <header class="flex justify-between items-center mb-12">
            <div>
                <h1 class="text-4xl md:text-5xl font-bold text-red-500 mb-2">Gestão TQPB</h1>
                <p class="text-lg text-gray-400">Sistema de Controle Financeiro</p>
            </div>
            <button class="btn-secondary px-4 py-2 rounded-md shadow-lg" onclick="App.logout()">Sair</button>
        </header>

        <!-- Conteúdo Principal -->
        <main id="main-content">
            <!-- O conteúdo será renderizado aqui pelo JavaScript -->
        </main>

        <!-- Navegação Inferior Fixa -->
        <nav class="fixed bottom-0 left-0 right-0 bg-gray-800 shadow-lg">
            <div class="container mx-auto flex justify-around p-2">
                <button class="text-gray-300 hover:text-red-400 transition-colors duration-300" onclick="App.render('home')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                    <span class="text-xs">Início</span>
                </button>
                 <button class="text-gray-300 hover:text-red-400 transition-colors duration-300" onclick="App.render('adeptosList')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197m0 0A6.995 6.995 0 0012 12.75a6.995 6.995 0 00-3-5.197M15 21a6 6 0 00-9-5.197" /></svg>
                    <span class="text-xs">Adeptos</span>
                </button>
                <button class="text-gray-300 hover:text-red-400 transition-colors duration-300" onclick="App.render('financeiroList')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" /></svg>
                    <span class="text-xs">Financeiro</span>
                </button>
                <button class="text-gray-300 hover:text-red-400 transition-colors duration-300" onclick="App.render('capital')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" /></svg>
                    <span class="text-xs">Capital</span>
                </button>
                 <button class="text-gray-300 hover:text-red-400 transition-colors duration-300" onclick="App.render('custos')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                    <span class="text-xs">Custos</span>
                </button>
                 <button class="text-gray-300 hover:text-red-400 transition-colors duration-300" onclick="App.render('contribuicoes')">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v.01M12 6v-1m0-1v-1m0 12v1m0 1v1m0-13a9 9 0 110 18 9 9 0 010-18zm0 0h.01" /></svg>
                    <span class="text-xs">Contribuições</span>
                </button>
            </div>
        </nav>
    </div>

    <script>
        const App = {
            config: {
                username: 'admcontrole',
                password: 'cova666'
            },
            db: null, // Onde os dados serão mantidos em memória
            state: { // Estado volátil da UI
                currentYear: new Date().getFullYear(),
                selectedCustoAno: null,
                selectedContribAno: null,
            },
            dataLimite: new Date(2024, 0, 1), // 1 de Janeiro de 2024

            /**
             * Inicializa a aplicação.
             */
            init: function() {
                // Verifica se o usuário já está logado na sessão atual
                if (sessionStorage.getItem('isLoggedIn') === 'true') {
                    this.showApp();
                } else {
                    this.showLogin();
                }
            },

            // 0. AUTENTICAÇÃO

            /**
             * Mostra a tela de login e esconde o app.
             */
            showLogin: function() {
                document.getElementById('login-screen').style.display = 'flex';
                document.getElementById('app').style.display = 'none';
            },

            /**
             * Mostra o app e esconde a tela de login.
             */
            showApp: function() {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('app').style.display = 'block';
                
                this.loadDB(); // Carrega os dados
                this.render(location.hash.slice(1) || 'home'); // Renderiza a página
                window.addEventListener('hashchange', () => this.render(location.hash.slice(1) || 'home'));
            },

            handleLogin: function() {
                const user = document.getElementById('username').value;
                const pass = document.getElementById('password').value;
                if (user === this.config.username && pass === this.config.password) {
                    sessionStorage.setItem('isLoggedIn', 'true');
                    this.showApp();
                } else {
                    alert('Usuário ou senha inválidos.');
                }
            },

            logout: function() {
                sessionStorage.removeItem('isLoggedIn');
                location.hash = ''; // Limpa o hash para evitar re-renderização indesejada
                this.showLogin();
            },

            // 1. GERENCIAMENTO DE DADOS (DB)

            /**
             * Carrega o banco de dados do LocalStorage. Se não existir, cria um DB padrão.
             */
            loadDB: function() {
                const dbJson = localStorage.getItem('tqpb_db');
                if (dbJson) {
                    this.db = JSON.parse(dbJson);
                } else {
                    // Se não houver DB, cria uma estrutura inicial
                    this.db = {
                        adeptos: [],
                        custos: [],
                        contribuicoes: []
                    };
                    this.saveDB();
                }
            },

            /**
             * Salva o estado atual do banco de dados no LocalStorage.
             */
            saveDB: function() {
                localStorage.setItem('tqpb_db', JSON.stringify(this.db));
            },

            // 2. RENDERIZAÇÃO E NAVEGAÇÃO

            /**
             * Renderiza a página solicitada no elemento #main-content.
             */
            render: function(page, data = {}) {
                const mainContent = document.getElementById('main-content');
                mainContent.innerHTML = '<div class="loader"></div>'; // Mostra o loader
                
                // Atualiza o hash da URL para navegação
                location.hash = page;

                let content = '';
                // Simula um pequeno atraso para o loader ser visível
                setTimeout(() => {
                    switch (page) {
                        case 'home':
                            content = this.renderHome();
                            break;
                        case 'adeptosList':
                            content = this.renderAdeptosList();
                            break;
                        case 'addAdepto':
                            content = this.renderAddAdeptoForm();
                            break;
                        case 'editAdepto':
                            content = this.renderAddAdeptoForm(data); // Reutiliza o formulário para edição
                            break;
                        case 'financeiroList':
                            content = this.renderFinanceiroList();
                            break;
                        case 'financeiroAdepto':
                            content = this.renderFinanceiroAdepto(data);
                            break;
                        case 'capital':
                            content = this.renderCapital();
                            break;
                        case 'custos':
                            content = this.renderCustos(data);
                            break;
                        case 'contribuicoes':
                            content = this.renderContribuicoes(data);
                            break;
                        case 'inadimplencia':
                            content = this.renderInadimplencia();
                            break;
                        default:
                            content = this.renderHome();
                    }
                    mainContent.innerHTML = content;
                }, 200); // Atraso de 200ms
            },

            /**
             * Renderiza a página inicial (Home).
             */
            renderHome: function() {
                return `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Adeptos -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Adeptos</h2>
                            <p class="text-gray-300 mb-6">Gestão completa do cadastro de adeptos.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('adeptosList')">Gerir Adeptos</button>
                        </div>
                        <!-- Financeiro -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.1s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Financeiro</h2>
                            <p class="text-gray-300 mb-6">Controle de mensalidades e débitos individuais.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('financeiroList')">Aceder ao Financeiro</button>
                        </div>
                        <!-- Custos -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.2s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Custos do Templo</h2>
                            <p class="text-gray-300 mb-6">Registo de despesas e custos operacionais.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('custos')">Ver Custos</button>
                        </div>
                        <!-- Inadimplência -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.3s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Inadimplência</h2>
                            <p class="text-gray-300 mb-6">Relatório de adeptos com pendências financeiras.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('inadimplencia')">Ver Relatório</button>
                        </div>
                        <!-- Capital -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.4s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Capital</h2>
                            <p class="text-gray-300 mb-6">Balanço financeiro geral do templo.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('capital')">Ver Balanço</button>
                        </div>
                        <!-- Contribuições -->
                        <div class="card-gradient rounded-lg shadow-xl p-6 flex flex-col justify-between hover:shadow-red-500/20 transition-all duration-300 fade-in" style="animation-delay: 0.5s;">
                            <h2 class="text-2xl font-semibold mb-4 text-red-400">Contribuições</h2>
                            <p class="text-gray-300 mb-6">Registo de doações e contribuições voluntárias.</p>
                            <button class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white font-semibold" onclick="App.render('contribuicoes')">Ver Contribuições</button>
                        </div>
                    </div>
                `;
            },

            // 3. SEÇÃO: ADEPTOS

            /**
             * Renderiza a lista de adeptos.
             */
            renderAdeptosList: function() {
                let content = `
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-semibold text-red-400">Lista de Adeptos</h2>
                        <button class="btn-primary px-4 py-2 rounded-md shadow-lg" onclick="App.render('addAdepto')">Adicionar Adepto</button>
                    </div>
                    <div class="card-gradient p-6 rounded-lg shadow-xl">
                `;

                if (this.db.adeptos.length === 0) {
                    content += '<p class="text-gray-400">Nenhum adepto cadastrado.</p>';
                } else {
                    content += '<ul class="space-y-4">';
                    this.db.adeptos.forEach((adepto, index) => {
                        content += `
                            <li class="flex flex-col md:flex-row justify-between items-start md:items-center p-4 bg-gray-700 rounded-md">
                                <span class="font-semibold text-gray-200">${adepto.nome}</span>
                                <div class="flex gap-4 mt-2 md:mt-0">
                                    <button class="text-blue-400 hover:text-blue-300" onclick="App.render('editAdepto', ${index})">Editar</button>
                                    <button class="text-red-500 hover:text-red-400" onclick="App.deleteAdepto(${index})">Apagar</button>
                                </div>
                            </li>
                        `;
                    });
                    content += '</ul>';
                }

                content += '</div>';
                return content;
            },

            /**
             * Renderiza o formulário para adicionar ou editar um adepto.
             */
            renderAddAdeptoForm: function(adeptoIndex = null) {
                const isEditing = adeptoIndex !== null;
                const adepto = isEditing ? this.db.adeptos[adeptoIndex] : {};
                const title = isEditing ? 'Editar Adepto' : 'Adicionar Novo Adepto';
                const buttonText = isEditing ? 'Atualizar Adepto' : 'Salvar Adepto';
                const action = `App.saveAdepto(${adeptoIndex})`;

                return `
                    <h2 class="text-3xl font-semibold mb-6 text-red-400">${title}</h2>
                    <div class="card-gradient p-6 rounded-lg shadow-xl">
                        <form id="adepto-form" class="space-y-4">
                            <div>
                                <label for="nome" class="block text-sm font-medium text-gray-300 mb-1">Nome Completo</label>
                                <input type="text" id="nome" value="${adepto.nome || ''}" class="form-input w-full rounded-md shadow-sm" required>
                            </div>
                            <div>
                                <label for="mensalidade" class="block text-sm font-medium text-gray-300 mb-1">Valor da Mensalidade (R$)</label>
                                <input type="number" id="mensalidade" value="${adepto.mensalidade || ''}" step="0.01" min="0" class="form-input w-full rounded-md shadow-sm" required>
                            </div>
                            <div class="flex justify-end gap-4 pt-4">
                                <button type="button" class="btn-secondary px-4 py-2 rounded-md" onclick="App.render('adeptosList')">Cancelar</button>
                                <button type="button" class="btn-primary px-4 py-2 rounded-md" onclick="${action}">${buttonText}</button>
                            </div>
                        </form>
                    </div>
                `;
            },

            /**
             * Salva um adepto (novo ou editado).
             */
            saveAdepto: function(adeptoIndex = null) {
                const nome = document.getElementById('nome').value;
                const mensalidade = parseFloat(document.getElementById('mensalidade').value);

                if (!nome || isNaN(mensalidade) || mensalidade < 0) {
                    alert('Por favor, preencha todos os campos corretamente.');
                    return;
                }

                if (adeptoIndex !== null) {
                    // Editando
                    this.db.adeptos[adeptoIndex].nome = nome;
                    this.db.adeptos[adeptoIndex].mensalidade = mensalidade;
                } else {
                    // Adicionando novo
                    const novoAdepto = {
                        id: Date.now(), // ID único
                        nome: nome,
                        mensalidade: mensalidade,
                        pagamentos: {} // Objeto para armazenar pagamentos por ano
                    };
                    this.db.adeptos.push(novoAdepto);
                }

                this.saveDB();
                this.render('adeptosList');
            },

            /**
             * Apaga um adepto.
             */
            deleteAdepto: function(index) {
                if (confirm(`Tem certeza que deseja apagar o adepto "${this.db.adeptos[index].nome}"? Esta ação não pode ser desfeita.`)) {
                    this.db.adeptos.splice(index, 1);
                    this.saveDB();
                    this.render('adeptosList');
                }
            },

            // 4. SEÇÃO: FINANCEIRO

            /**
             * Renderiza a lista de adeptos para acesso ao financeiro.
             */
            renderFinanceiroList: function() {
                let content = `<h2 class="text-3xl font-semibold mb-6 text-red-400">Financeiro - Selecione um Adepto</h2>`;
                content += '<div class="card-gradient p-6 rounded-lg shadow-xl">';

                if (this.db.adeptos.length === 0) {
                    content += '<p class="text-gray-400">Nenhum adepto cadastrado. Adicione um adepto primeiro.</p>';
                } else {
                    content += '<ul class="space-y-2">';
                    this.db.adeptos.forEach((adepto, index) => {
                        content += `
                            <li>
                                <button class="w-full text-left p-4 bg-gray-700 rounded-md hover:bg-gray-600 transition-colors duration-200" onclick="App.render('financeiroAdepto', ${index})">
                                    <span class="font-semibold text-gray-200">${adepto.nome}</span>
                                </button>
                            </li>
                        `;
                    });
                    content += '</ul>';
                }

                content += '</div>';
                return content;
            },

            /**
             * Renderiza a página de detalhes financeiros de um adepto.
             */
            renderFinanceiroAdepto: function(adeptoIndex) {
                const adepto = this.db.adeptos[adeptoIndex];
                if (!adepto) return this.renderFinanceiroList(); // Segurança

                // Garante que a estrutura de pagamentos existe
                if (!adepto.pagamentos) adepto.pagamentos = {};
                if (!adepto.pagamentos[this.state.currentYear]) adepto.pagamentos[this.state.currentYear] = [];

                let content = `
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-3xl font-semibold text-red-400">${adepto.nome}</h2>
                        <button class="btn-secondary px-4 py-2 rounded-md" onclick="App.render('financeiroList')">Voltar</button>
                    </div>
                    <p class="text-gray-400 mb-6">Mensalidade: ${this.formatCurrency(adepto.mensalidade)}</p>
                `;

                // Navegação de Ano
                content += `
                    <div class="flex justify-center items-center gap-4 mb-6">
                        <button class="btn-secondary p-2 rounded-full" onclick="App.changeYear(${adeptoIndex}, -1)">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                        </button>
                        <span class="text-2xl font-semibold text-gray-200">${this.state.currentYear}</span>
                        <button class="btn-secondary p-2 rounded-full" onclick="App.changeYear(${adeptoIndex}, 1)">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" /></svg>
                        </button>
                    </div>
                `;

                // Grid de Meses
                content += '<div class="card-gradient p-6 rounded-lg shadow-xl"><div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">';
                const meses = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
                const pagamentosDoAno = adepto.pagamentos[this.state.currentYear] || [];

                meses.forEach((mes, mesIndex) => {
                    const isPago = pagamentosDoAno.includes(mesIndex);
                    const isPassado = new Date(this.state.currentYear, mesIndex) < new Date() && !isPago;
                    
                    let statusClass = 'bg-gray-600 hover:bg-gray-500'; // Padrão (futuro)
                    if (isPago) {
                        statusClass = 'bg-green-600 hover:bg-green-500'; // Pago
                    } else if (isPassado) {
                        statusClass = 'bg-red-700 hover:bg-red-600'; // Atrasado
                    }

                    content += `
                        <button class="p-4 rounded-md text-white font-semibold transition-colors duration-200 ${statusClass}" onclick="App.togglePagamento(${adeptoIndex}, ${this.state.currentYear}, ${mesIndex})">
                            ${mes}
                        </button>
                    `;
                });

                content += '</div></div>';
                return content;
            },

            /**
             * Alterna o status de pagamento de um mês para um adepto.
             */
            togglePagamento: function(adeptoIndex, ano, mesIndex) {
                const adepto = this.db.adeptos[adeptoIndex];
                if (!adepto.pagamentos[ano]) {
                    adepto.pagamentos[ano] = [];
                }

                const pagamentosDoAno = adepto.pagamentos[ano];
                const pagamentoIndex = pagamentosDoAno.indexOf(mesIndex);

                if (pagamentoIndex > -1) {
                    // Se já pagou, remove o pagamento (estorna)
                    pagamentosDoAno.splice(pagamentoIndex, 1);
                } else {
                    // Se não pagou, adiciona o pagamento
                    pagamentosDoAno.push(mesIndex);
                }

                this.saveDB();
                this.render('financeiroAdepto', adeptoIndex); // Re-renderiza a página do adepto
            },

            /**
             * Muda o ano na visualização financeira.
             */
            changeYear: function(adeptoIndex, direction) {
                this.state.currentYear += direction;
                this.render('financeiroAdepto', adeptoIndex);
            },

            // 5. SEÇÃO: CAPITAL E CUSTOS

            /**
             * Renderiza a página de balanço de capital.
             */
            renderCapital: function() {
                let totalMensalidades = 0;
                let totalContribuicoes = 0;
                let totalCustosPagos = 0;
                let totalCustosPendentes = 0;

                // Calcula total de mensalidades pagas
                this.db.adeptos.forEach(adepto => {
                    if (adepto.pagamentos) {
                        Object.keys(adepto.pagamentos).forEach(ano => {
                            const dataAno = parseInt(ano, 10);
                            // Considera apenas a partir de 2024
                            if (dataAno >= 2024) {
                                totalMensalidades += adepto.pagamentos[ano].length * adepto.mensalidade;
                            }
                        });
                    }
                });

                // Calcula total de contribuições
                this.db.contribuicoes.forEach(c => {
                    const dataContrib = this.parseDate(c.data);
                    if (dataContrib && dataContrib >= this.dataLimite) {
                        totalContribuicoes += c.valor;
                    }
                });

                // Calcula totais de custos
                this.db.custos.forEach(custo => {
                    const dataCusto = this.parseDate(custo.data);
                    if (dataCusto && dataCusto >= this.dataLimite) {
                        if (custo.pago) {
                            totalCustosPagos += custo.valor;
                        } else {
                            totalCustosPendentes += custo.valor;
                        }
                    }
                });

                const receitaTotal = totalMensalidades + totalContribuicoes;
                const balanco = receitaTotal - totalCustosPagos;

                let content = `
                    <h2 class="text-3xl font-semibold mb-6 text-red-400">Balanço de Capital (a partir de 2024)</h2>
                    <div class="space-y-6">
                        <!-- Receitas -->
                        <div class="card-gradient p-6 rounded-lg shadow-xl">
                            <h3 class="text-xl font-semibold mb-4 text-gray-200">Receitas</h3>
                            <div class="space-y-2">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Total de Mensalidades Recebidas:</span>
                                    <span class="font-bold text-green-400">${this.formatCurrency(totalMensalidades)}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Total de Contribuições Voluntárias:</span>
                                    <span class="font-bold text-green-400">${this.formatCurrency(totalContribuicoes)}</span>
                                </div>
                                <div class="flex justify-between items-center border-t border-gray-600 pt-2 mt-2">
                                    <span class="text-lg font-semibold text-gray-200">Receita Total:</span>
                                    <span class="text-lg font-bold text-green-300">${this.formatCurrency(receitaTotal)}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Despesas -->
                        <div class="card-gradient p-6 rounded-lg shadow-xl">
                            <h3 class="text-xl font-semibold mb-4 text-gray-200">Despesas</h3>
                            <div class="space-y-2">
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Custos Pagos:</span>
                                    <span class="font-bold text-red-400">${this.formatCurrency(totalCustosPagos)}</span>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-gray-300">Custos Pendentes (A Pagar):</span>
                                    <span class="font-bold text-yellow-400">${this.formatCurrency(totalCustosPendentes)}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Balanço Final -->
                        <div class="card-gradient p-6 rounded-lg shadow-xl border ${balanco >= 0 ? 'border-green-500' : 'border-red-500'}">
                            <div class="flex justify-between items-center text-xl">
                                <span class="font-semibold text-gray-100">Balanço Final (Caixa):</span>
                                <span class="font-bold ${balanco >= 0 ? 'text-green-400' : 'text-red-400'}">${this.formatCurrency(balanco)}</span>
                            </div>
                            <p class="text-sm text-gray-400 mt-2">(Receita Total - Custos Pagos)</p>
                        </div>
                    </div>
                `;
                return content;
            },

            /**
             * Renderiza a página de custos do templo.
             */
            renderCustos: function(data = {}) {
                let content = `<h2 class="text-3xl font-semibold mb-6 text-red-400">Custos do Templo</h2>`;
                const editingIndex = data.editingIndex !== undefined ? data.editingIndex : null;
                const isEditing = editingIndex !== null;
                const custo = isEditing ? this.db.custos[editingIndex] : {};
                
                // Formulário para adicionar/editar custo
                content += `
                    <div class="card-gradient p-6 rounded-lg shadow-xl mb-6">
                        <h3 class="text-xl font-semibold mb-4 text-gray-200">${isEditing ? 'Editar Custo' : 'Adicionar Novo Custo'}</h3>
                        <form id="add-custo-form" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="date" id="custo-data" class="form-input rounded-md shadow-sm" style="color-scheme: dark;" value="${custo.data || ''}" required>
                            <input type="text" id="custo-obs" placeholder="Observação" class="form-input rounded-md shadow-sm" value="${custo.obs || ''}" required>
                            <input type="number" id="custo-valor" placeholder="Valor (R$)" step="0.01" min="0.01" class="form-input rounded-md shadow-sm" value="${custo.valor || ''}" required>
                            <div class="md:col-span-3">
                                <button type="button" class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white" onclick="App.adicionarCusto(${editingIndex})">
                                    ${isEditing ? 'Atualizar Custo' : 'Adicionar Custo'}
                                </button>
                                ${isEditing ? `<button type="button" class="btn-secondary w-full px-4 py-2 rounded-md shadow-lg text-white mt-2" onclick="App.render('custos')">Cancelar Edição</button>` : ''}
                            </div>
                        </form>
                    </div>
                `;

                // Agrupamento de custos por ano e mês
                const custosAgrupados = {};
                this.db.custos.forEach((custo, index) => {
                    const data = this.parseDate(custo.data);
                    if (data) {
                        const ano = data.getFullYear();
                        const mes = data.getMonth();
                        if (!custosAgrupados[ano]) custosAgrupados[ano] = {};
                        if (!custosAgrupados[ano][mes]) custosAgrupados[ano][mes] = [];
                        custosAgrupados[ano][mes].push({ ...custo, originalIndex: index });
                    }
                });

                const anos = Object.keys(custosAgrupados).sort((a, b) => b - a);

                // Lista de custos registrados
                content += `<div class="card-gradient p-6 rounded-lg shadow-xl">
                                <h3 class="text-xl font-semibold mb-4 text-gray-200">Custos Registrados</h3>
                `;

                if (anos.length === 0) {
                    content += `<p class="text-gray-400">Nenhum custo registrado.</p>`;
                } else {
                    // Botões de Ano
                    content += `<div class="flex flex-wrap gap-2 mb-4">`;
                    anos.forEach(ano => {
                        const isSelected = ano == this.state.selectedCustoAno; // Usar '==' para comparar string com número se necessário
                        content += `<button class="px-4 py-2 rounded-md text-white ${isSelected ? 'btn-primary' : 'btn-secondary'}" onclick="App.selectCustoAno('${ano}')">${ano}</button>`;
                    });
                    content += `</div>`;

                    // Botões de Mês e Lista de Custos
                    if (this.state.selectedCustoAno && custosAgrupados[this.state.selectedCustoAno]) {
                        const anoData = custosAgrupados[this.state.selectedCustoAno];
                        const meses = Object.keys(anoData).sort((a, b) => a - b);
                        const nomesMeses = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];

                        meses.forEach(mes => {
                            content += `<h4 class="text-lg font-semibold text-red-300 mt-4 mb-2">${nomesMeses[mes]}</h4>`;
                            content += `<div class="space-y-3">`;
                            anoData[mes].forEach(custo => {
                                const dataCusto = this.parseDate(custo.data);
                                const isHistorico = dataCusto && dataCusto < this.dataLimite;
                                let statusClass, statusTexto;
                                if (isHistorico) {
                                    statusClass = 'bg-gray-500'; statusTexto = 'Pago (Histórico)';
                                } else if (custo.pago) {
                                    statusClass = 'bg-green-500'; statusTexto = 'Pago';
                                } else {
                                    statusClass = 'bg-red-500'; statusTexto = 'Pendente';
                                }

                                content += `
                                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center p-3 bg-gray-700 rounded-md gap-2">
                                        <div class="flex-1">
                                            <p class="font-semibold text-gray-200">${this.formatDate(custo.data)} - ${custo.obs}</p>
                                            <p class="text-sm text-gray-300">${this.formatCurrency(custo.valor)}</p>
                                        </div>
                                        <div class="flex items-center gap-2 w-full md:w-auto">
                                            <button class="flex-grow md:flex-grow-0 px-3 py-1 rounded-md text-white text-xs font-medium ${statusClass} ${isHistorico ? 'opacity-70 cursor-not-allowed' : ''}"
                                                    onclick="App.toggleCustoStatus(${custo.originalIndex})" ${isHistorico ? 'disabled' : ''}>
                                                ${statusTexto} ${!isHistorico ? '(Mudar)' : ''}
                                            </button>
                                            <button class="text-blue-400 hover:text-blue-300 p-1" onclick="App.render('custos', { editingIndex: ${custo.originalIndex} })" title="Editar">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                                            </button>
                                            <button class="text-red-500 hover:text-red-400 p-1" onclick="App.apagarCusto(${custo.originalIndex})" title="Apagar">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                                            </button>
                                        </div>
                                    </div>
                                `;
                            });
                            content += `</div>`;
                        });
                    }
                }
                content += `</div>`; // Fim do card

                return content;
            },

            /**
             * Adiciona ou atualiza um custo na base de dados.
             */
            adicionarCusto: function(editingIndex = null) {
                const data = document.getElementById('custo-data').value;
                const obs = document.getElementById('custo-obs').value;
                const valor = parseFloat(document.getElementById('custo-valor').value);

                if (data && obs && valor > 0) {
                    if (editingIndex !== null) {
                        const custoExistente = this.db.custos[editingIndex];
                        custoExistente.data = data;
                        custoExistente.obs = obs;
                        custoExistente.valor = valor;
                    } else {
                        this.db.custos.push({ data, obs, valor, pago: false });
                    }
                    this.saveDB();
                    this.render('custos');
                } else {
                    alert("Por favor, preencha todos os campos do custo.");
                }
            },

            /**
             * Apaga um custo.
             */
            apagarCusto: function(index) {
                if (confirm('Tem a certeza que quer apagar este custo?')) {
                    this.db.custos.splice(index, 1);
                    this.saveDB();
                    this.render('custos');
                }
            },

            /**
             * Alterna o status de pagamento de um custo.
             */
            toggleCustoStatus: function(index) {
                const custo = this.db.custos[index];
                if (custo) {
                    custo.pago = !custo.pago;
                    this.saveDB();
                }
                this.render('custos'); // Redesenha
            },

            /**
             * Seleciona um ano para filtrar os custos e re-renderiza.
             */
            selectCustoAno: function(ano) {
                // Se clicar no mesmo ano, deseleciona.
                this.state.selectedCustoAno = this.state.selectedCustoAno == ano ? null : ano;
                this.render('custos');
            },

            // 5.1. SEÇÃO: CONTRIBUIÇÕES

            /**
             * Renderiza a página de contribuições voluntárias.
             */
            renderContribuicoes: function(data = {}) {
                const editingIndex = data.editingIndex !== undefined ? data.editingIndex : null;
                let content = `<h2 class="text-3xl font-semibold mb-6 text-red-400">Contribuições Voluntárias</h2>`;
                const isEditing = editingIndex !== null;
                const contrib = isEditing ? this.db.contribuicoes[editingIndex] : {};
                
                // Formulário para adicionar/editar contribuição
                content += `
                    <div class="card-gradient p-6 rounded-lg shadow-xl mb-6">
                        <h3 class="text-xl font-semibold mb-4 text-gray-200">${isEditing ? 'Editar Contribuição' : 'Adicionar Nova Contribuição'}</h3>
                        <form id="add-contrib-form" class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="date" id="contrib-data" class="form-input rounded-md shadow-sm" style="color-scheme: dark;" value="${contrib.data || ''}" required>
                            <input type="text" id="contrib-obs" placeholder="Observação" class="form-input rounded-md shadow-sm" value="${contrib.obs || ''}" required>
                            <input type="number" id="contrib-valor" placeholder="Valor (R$)" step="0.01" min="0.01" class="form-input rounded-md shadow-sm" value="${contrib.valor || ''}" required>
                            <div class="md:col-span-3">
                                <button type="button" class="btn-primary w-full px-4 py-2 rounded-md shadow-lg text-white" onclick="App.adicionarContribuicao(${editingIndex})">
                                    ${isEditing ? 'Atualizar Contribuição' : 'Adicionar Contribuição'}
                                </button>
                                ${isEditing ? `<button type="button" class="btn-secondary w-full px-4 py-2 rounded-md shadow-lg text-white mt-2" onclick="App.render('contribuicoes')">Cancelar Edição</button>` : ''}
                            </div>
                        </form>
                    </div>
                `;

                // Agrupamento de contribuições por ano e mês
                const contribsAgrupadas = {};
                this.db.contribuicoes.forEach((contrib, index) => {
                    const data = this.parseDate(contrib.data);
                    if (data) {
                        const ano = data.getFullYear();
                        const mes = data.getMonth();
                        if (!contribsAgrupadas[ano]) contribsAgrupadas[ano] = {};
                        if (!contribsAgrupadas[ano][mes]) contribsAgrupadas[ano][mes] = [];
                        contribsAgrupadas[ano][mes].push({ ...contrib, originalIndex: index });
                    }
                });

                const anos = Object.keys(contribsAgrupadas).sort((a, b) => b - a);

                // Lista de contribuições registradas
                content += `<div class="card-gradient p-6 rounded-lg shadow-xl">
                                <h3 class="text-xl font-semibold mb-4 text-gray-200">Contribuições Registradas</h3>
                `;

                if (anos.length === 0) {
                    content += `<p class="text-gray-400">Nenhuma contribuição registrada.</p>`;
                } else {
                    // Botões de Ano
                    content += `<div class="flex flex-wrap gap-2 mb-4">`;
                    anos.forEach(ano => {
                        const isSelected = ano == this.state.selectedContribAno;
                        content += `<button class="px-4 py-2 rounded-md text-white ${isSelected ? 'btn-primary' : 'btn-secondary'}" onclick="App.selectContribAno('${ano}')">${ano}</button>`;
                    });
                    content += `</div>`;

                    // Botões de Mês e Lista de Contribuições
                    if (this.state.selectedContribAno && contribsAgrupadas[this.state.selectedContribAno]) {
                        const anoData = contribsAgrupadas[this.state.selectedContribAno];
                        const meses = Object.keys(anoData).sort((a, b) => a - b);
                        const nomesMeses = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];

                        meses.forEach(mes => {
                            content += `<h4 class="text-lg font-semibold text-red-300 mt-4 mb-2">${nomesMeses[mes]}</h4>`;
                            content += `<div class="space-y-3">`;
                            anoData[mes].forEach(c => {
                                content += `
                                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center p-3 bg-gray-700 rounded-md gap-2">
                                        <div class="flex-1">
                                            <p class="font-semibold text-gray-200">${this.formatDate(c.data)} - ${c.obs}</p>
                                            <p class="text-sm text-green-400">${this.formatCurrency(c.valor)}</p>
                                        </div>
                                        <div class="flex gap-2">
                                            <button class="text-blue-400 hover:text-blue-300 p-1" onclick="App.render('contribuicoes', { editingIndex: ${c.originalIndex} })" title="Editar">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                                            </button>
                                            <button class="text-red-500 hover:text-red-400 p-1" onclick="App.apagarContribuicao(${c.originalIndex})" title="Apagar">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                                            </button>
                                        </div>
                                    </div>
                                `;
                            });
                            content += `</div>`;
                        });
                    }
                }
                content += `</div>`; // Fim do card

                return content;
            },

            /**
             * Adiciona ou atualiza uma contribuição.
             */
            adicionarContribuicao: function(editingIndex = null) {
                const data = document.getElementById('contrib-data').value;
                const obs = document.getElementById('contrib-obs').value;
                const valor = parseFloat(document.getElementById('contrib-valor').value);

                if (data && obs && valor > 0) {
                    const novaContrib = { data, obs, valor };
                    if (editingIndex !== null) {
                        this.db.contribuicoes[editingIndex] = novaContrib;
                    } else {
                        this.db.contribuicoes.push(novaContrib);
                    }
                    this.saveDB();
                    this.render('contribuicoes');
                } else {
                    alert("Por favor, preencha todos os campos da contribuição.");
                }
            },

            /**
             * Apaga uma contribuição.
             */
            apagarContribuicao: function(index) {
                if (confirm('Tem a certeza que quer apagar esta contribuição?')) {
                    this.db.contribuicoes.splice(index, 1);
                    this.saveDB();
                    this.render('contribuicoes');
                }
            },

            /**
             * Seleciona um ano para filtrar as contribuições e re-renderiza.
             */
            selectContribAno: function(ano) {
                // Se clicar no mesmo ano, deseleciona.
                this.state.selectedContribAno = this.state.selectedContribAno == ano ? null : ano;
                this.render('contribuicoes');
            },

            // 6. SEÇÃO: INADIMPLÊNCIA

            /**
             * Renderiza o relatório de inadimplência.
             */
            renderInadimplencia: function() {
                let content = `<h2 class="text-3xl font-semibold mb-6 text-red-400">Relatório de Inadimplência</h2>`;
                content += '<div class="card-gradient p-6 rounded-lg shadow-xl">';
                
                let inadimplentesEncontrados = false;
                let totalDevido = 0;

                const agora = new Date();
                const anoAtual = agora.getFullYear();
                const mesAtual = agora.getMonth();

                content += '<div class="space-y-6">';

                this.db.adeptos.forEach(adepto => {
                    if (adepto.mensalidade > 0) {
                        let mesesDevidos = [];
                        // Itera de 2024 até o ano atual
                        for (let ano = 2024; ano <= anoAtual; ano++) {
                            const pagamentosDoAno = (adepto.pagamentos && adepto.pagamentos[ano]) ? adepto.pagamentos[ano] : [];
                            const limiteMes = (ano < anoAtual) ? 11 : mesAtual - 1; // Mês anterior ao atual

                            for (let mes = 0; mes <= limiteMes; mes++) {
                                if (!pagamentosDoAno.includes(mes)) {
                                    mesesDevidos.push({ ano, mes });
                                }
                            }
                        }

                        if (mesesDevidos.length > 0) {
                            inadimplentesEncontrados = true;
                            const valorDevido = mesesDevidos.length * adepto.mensalidade;
                            totalDevido += valorDevido;
                            
                            content += `
                                <div class="p-4 bg-gray-700 rounded-md">
                                    <div class="flex justify-between items-center">
                                        <h4 class="text-lg font-semibold text-gray-200">${adepto.nome}</h4>
                                        <span class="font-bold text-red-400">${this.formatCurrency(valorDevido)}</span>
                                    </div>
                                    <p class="text-sm text-gray-400 mt-1">Meses em atraso: ${mesesDevidos.length}</p>
                                </div>
                            `;
                        }
                    }
                });

                content += '</div>';

                if (!inadimplentesEncontrados) {
                    content += '<p class="text-gray-400">Nenhum adepto inadimplente encontrado.</p>';
                }

                // Rodapé com total
                content += `
                    <footer class="border-t border-gray-700 mt-6 pt-4">
                        <div class="flex justify-between items-center text-lg">
                            <span class="text-gray-300">Total Geral Devido:</span>
                            <span class="font-bold text-red-500">${this.formatCurrency(totalDevido)}</span>
                        </div>
                    </footer>
                `;

                content += '</div>';
                return content;
            },

            // 7. FUNÇÕES UTILITÁRIAS

            /**
             * Formata um número como moeda (BRL).
             */
            formatCurrency: function(value) {
                return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value || 0);
            },

            /**
             * Formata uma data (string YYYY-MM-DD) para DD/MM/YYYY.
             */
            formatDate: function(dateString) {
                if (!dateString) return '';
                const [year, month, day] = dateString.split('-');
                return `${day}/${month}/${year}`;
            },

            /**
             * Converte uma string de data (YYYY-MM-DD) para um objeto Date.
             */
            parseDate: function(dateString) {
                if (!dateString) return null;
                const parts = dateString.split('-');
                // new Date(year, monthIndex, day) - monthIndex é 0-11
                return new Date(parts[0], parts[1] - 1, parts[2]);
            }
        };

        // Inicializa a aplicação quando o DOM estiver pronto
        document.addEventListener('DOMContentLoaded', () => App.init()); // A inicialização agora cuida do login
    </script>
</body>
</html>
